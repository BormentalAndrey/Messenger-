name: Android CI

on:
  push:
    branches: [ main, master ]
  workflow_dispatch:

jobs:
  debug-unzip:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Show workspace root
        run: |
          echo "PWD=$(pwd)"
          echo "=== ROOT FILES ==="
          ls -la

      - name: Search zip file
        run: |
          echo "=== SEARCH ZIP ==="
          find . -name "*.zip" -type f || true

      - name: Fail if archive not found
        run: |
          if [ ! -f "./termux-library/termux-app-master.zip" ]; then
            echo "‚ùå ARCHIVE NOT FOUND:"
            echo "./termux-library/termux-app-master.zip"
            exit 1
          fi

      - name: Inspect archive
        run: |
          ls -lh termux-library/termux-app-master.zip
          file termux-library/termux-app-master.zip

      - name: Install unzip
        run: sudo apt-get update && sudo apt-get install -y unzip

      - name: Try unzip with full log
        run: |
          mkdir -p out
          unzip -v termux-library/termux-app-master.zip
          unzip termux-library/termux-app-master.zip -d out

      - name: Show result
        run: |
          echo "=== OUT DIR ==="
          find out -maxdepth 4
