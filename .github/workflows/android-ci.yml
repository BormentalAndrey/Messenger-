name: Android CI - Unpack Termux

on:
  workflow_dispatch:

jobs:
  unpack:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Extract and Move
        run: |
          # 1. Создаем папку Termux-library (если её нет)
          mkdir -p Termux-library
          
          # 2. Распаковываем. Если путь верный, файлы попадут в tmp_dir
          # ВНИМАНИЕ: Проверьте, что в репозитории реально есть папка termux-library (с маленькой буквы)
          # и в ней лежит файл termux-app-master.zip
          unzip -q termux-library/termux-app-master.zip -d tmp_dir
          
          # 3. Перемещаем содержимое. 
          # Мы берем всё из первой найденной папки внутри архива
          shopt -s dotglob
          mv tmp_dir/*/* Termux-library/ || mv tmp_dir/* Termux-library/
          
          # 4. Проверяем, что получилось (вывод в лог)
          echo "Список файлов в Termux-library:"
          ls -R Termux-library/
          
          # 5. Чистим мусор
          rm -rf tmp_dir

      - name: Upload Artifact
        uses: actions/upload-artifact@v4
        with:
          name: termux-ready
          path: Termux-library/
          
