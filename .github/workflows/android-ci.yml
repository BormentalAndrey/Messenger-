name: Unpack Termux Archive

on:
  push:
    branches:
      - main  # замените на вашу основную ветку, если нужно
  workflow_dispatch:  # позволяет запускать вручную

jobs:
  unpack:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Install unzip
        run: sudo apt-get update && sudo apt-get install -y unzip

      - name: Unpack archive
        run: |
          # Переходим в директорию с архивом
          cd app/src/main/kotlin/com/kakdela/p2p/ui/terminal

          # Распаковываем (с перезаписью, если файлы уже есть)
          unzip -o termux-app-master.zip

          # Перемещаем содержимое внутренней папки termux-app-master в текущую директорию
          mv termux-app-master/* .
          mv termux-app-master/.* . 2>/dev/null || true  # скрытые файлы, если есть

          # Удаляем пустую внутреннюю папку и сам архив (опционально)
          rmdir termux-app-master
          rm termux-app-master.zip

          echo "Архив успешно распакован в app/src/main/kotlin/com/kakdela/p2p/ui/terminal"
